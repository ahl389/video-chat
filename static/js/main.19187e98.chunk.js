(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{14:function(t,e,n){},193:function(t,e,n){"use strict";n.r(e);var i={};n.r(i),n.d(i,"None",(function(){return b})),n.d(i,"Snowfall",(function(){return k})),n.d(i,"GreenRed",(function(){return O})),n.d(i,"Twinkle",(function(){return y})),n.d(i,"BlackWhite",(function(){return x}));var a=n(0),r=n(3),c=n.n(r),o=n(78),s=n.n(o),l=(n(85),n(33)),u=n.n(l),d=n(79),h=n(8),p=n(9),f=n(7),m=n(11),v=n(10),j=(n(14),n(22));function b(t){return Object(a.jsx)("div",{className:"filter none"})}n(87);function k(t){return Object(a.jsx)("div",{className:"filter snowfall",children:Array(100).fill().map((function(t){return Object(a.jsx)("div",{className:"snowflake"})}))})}n(88);function O(t){return Object(a.jsx)("div",{className:"filter green_red"})}n(89);var y=function(t){Object(m.a)(n,t);var e=Object(v.a)(n);function n(t){var i;return Object(h.a)(this,n),(i=e.call(this,t)).state={height:30},i.twinkle=c.a.createRef(),i.setHeight=i.setHeight.bind(Object(f.a)(i)),i}return Object(p.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.setHeight)}},{key:"setHeight",value:function(){var t=2*this.twinkle.current.width;this.setState({height:t})}},{key:"render",value:function(){var t=this;return Object(a.jsx)("div",{className:"filter twinkle",ref:this.twinkle,children:Array(7).fill().map((function(e){return Object(a.jsxs)("div",{className:"light",style:{height:t.state.height},children:[Object(a.jsx)("div",{className:"fixture"}),Object(a.jsx)("div",{className:"bulb"}),Object(a.jsx)("div",{className:"string"})]})}))})}}]),n}(r.Component),x=(n(90),function(t){Object(m.a)(n,t);var e=Object(v.a)(n);function n(t){var i;return Object(h.a)(this,n),(i=e.call(this,t)).state={video:null},i.ref=c.a.createRef(),i}return Object(p.a)(n,[{key:"componentDidMount",value:function(){var t=this.ref.current.parentElement.parentElement.querySelector(".video").firstChild;t.style.webkitFilter="grayscale(100%)",this.setState({video:t})}},{key:"componentWillUnmount",value:function(){this.state.video.style.webkitFilter="none"}},{key:"render",value:function(){return Object(a.jsx)("div",{className:"filter black_white",ref:this.ref})}}]),n}(r.Component));var g=function(t){var e=i[t.name];return Object(a.jsx)(e,{})},R=function(t){Object(m.a)(n,t);var e=Object(v.a)(n);function n(t){var i;return Object(h.a)(this,n),(i=e.call(this,t)).state={filter:""},i.ref=c.a.createRef(),i}return Object(p.a)(n,[{key:"componentDidMount",value:function(){var t=this;if(this.props.track)if("data"!==this.props.track.kind){var e=this.props.track.attach();this.ref.current.classList.add(this.props.track.kind),this.ref.current.appendChild(e)}else this.props.track.on("message",(function(e){t.setState({filter:e})}))}},{key:"render",value:function(){return Object(a.jsx)("div",{className:"track",ref:this.ref,children:this.props.track&&"data"===this.props.track.kind?Object(a.jsx)(g,{name:this.state.filter||this.props.filter}):""})}}]),n}(r.Component);var S=function(t){return Object(a.jsx)("div",{className:"filterMenu",children:["None","Snowfall","GreenRed","Twinkle"].map((function(e){return Object(a.jsx)("div",{className:"icon icon-".concat(e),onClick:function(){return t.changeFilter(e)},children:e})}))})},w=function(t){Object(m.a)(n,t);var e=Object(v.a)(n);function n(t){var i;Object(h.a)(this,n),i=e.call(this,t);var a=Array.from(i.props.participant.tracks.values()).map((function(t){return t.track})).filter((function(t){return null!==t}));return i.state={tracks:a,filter:"None"},i.changeFilter=i.changeFilter.bind(Object(f.a)(i)),i}return Object(p.a)(n,[{key:"componentDidMount",value:function(){var t=this;this.props.localParticipant||(this.props.participant.on("trackSubscribed",(function(e){return t.addTrack(e)})),this.props.participant.on("trackPublished",(function(e){return t.addTrack(e.track)})))}},{key:"addTrack",value:function(t){this.setState({tracks:[].concat(Object(j.a)(this.state.tracks),[t])})}},{key:"changeFilter",value:function(t){this.state.tracks.find((function(t){return"data"==t.kind})).send(t),this.setState({filter:t})}},{key:"render",value:function(){var t=this,e=this.props.dominantSpeaker===this.props.participant.identity?"dominantSpeaker":"";return Object(a.jsxs)("div",{className:"participant ".concat(e),id:this.props.participant.identity,children:[Object(a.jsx)("div",{className:"identity",children:this.props.participant.identity}),this.props.localParticipant?Object(a.jsx)(S,{changeFilter:this.changeFilter}):"",this.state.tracks.map((function(e){return Object(a.jsx)(R,{filter:t.state.filter,track:e},e)}))]})}}]),n}(r.Component),P=function(t){Object(m.a)(n,t);var e=Object(v.a)(n);function n(t){var i;return Object(h.a)(this,n),(i=e.call(this,t)).state={remoteParticipants:Array.from(i.props.room.participants.values())},i.leaveRoom=i.leaveRoom.bind(Object(f.a)(i)),i}return Object(p.a)(n,[{key:"componentDidMount",value:function(){var t=this;this.props.room.on("participantConnected",(function(e){return t.addParticipant(e)})),this.props.room.on("participantDisconnected",(function(e){return t.removeParticipant(e)})),this.props.room.on("dominantSpeakerChanged",(function(e){return t.highlightDominantSpeaker(e)})),window.addEventListener("beforeunload",this.leaveRoom)}},{key:"componentWillUnmount",value:function(){this.leaveRoom()}},{key:"leaveRoom",value:function(){this.props.room.disconnect(),this.props.leaveRoom()}},{key:"addParticipant",value:function(t){console.log("".concat(t.identity," has joined the room.")),this.setState({remoteParticipants:[].concat(Object(j.a)(this.state.remoteParticipants),[t])})}},{key:"removeParticipant",value:function(t){console.log("".concat(t.identity," has left the room")),this.setState({remoteParticipants:this.state.remoteParticipants.filter((function(e){return e.identity!=t.identity}))})}},{key:"highlightDominantSpeaker",value:function(t){this.setState({dominantSpeaker:t.identity})}},{key:"render",value:function(){var t=this;return Object(a.jsxs)("div",{className:"room",children:[Object(a.jsxs)("div",{className:"participants",children:[Object(a.jsx)(w,{dominantSpeaker:this.state.dominantSpeaker,localParticipant:"true",participant:this.props.room.localParticipant},this.props.room.localParticipant.identity),this.state.remoteParticipants.map((function(e){return Object(a.jsx)(w,{dominantSpeaker:t.state.dominantSpeaker,participant:e},e.identity)}))]}),Object(a.jsx)("button",{id:"leaveRoom",onClick:this.leaveRoom,children:"Leave Room"})]})}}]),n}(r.Component),N=n(91),C=N.connect,T=N.LocalDataTrack,F=function(t){Object(m.a)(n,t);var e=Object(v.a)(n);function n(t){var i;return Object(h.a)(this,n),(i=e.call(this,t)).state={identity:"",room:null},i.inputRef=c.a.createRef(),i.joinRoom=i.joinRoom.bind(Object(f.a)(i)),i.leaveRoom=i.leaveRoom.bind(Object(f.a)(i)),i.updateIdentity=i.updateIdentity.bind(Object(f.a)(i)),i.removePlaceholderText=i.removePlaceholderText.bind(Object(f.a)(i)),i}return Object(p.a)(n,[{key:"joinRoom",value:function(){var t=Object(d.a)(u.a.mark((function t(){var e,n,i,a;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("https://backend-9288-dev.twil.io/token?identity=".concat(this.state.identity));case 3:return e=t.sent,t.next=6,e.json();case 6:return n=t.sent,t.next=9,C(n.accessToken,{name:"secret-santa4",audio:!0,video:!0,dominantSpeaker:!0});case 9:return i=t.sent,a=new T,t.next=13,i.localParticipant.publishTrack(a);case 13:this.setState({room:i}),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(0),console.log(t.t0);case 19:case"end":return t.stop()}}),t,this,[[0,16]])})));return function(){return t.apply(this,arguments)}}()},{key:"leaveRoom",value:function(){this.setState({room:null})}},{key:"updateIdentity",value:function(t){this.setState({identity:t.target.value})}},{key:"removePlaceholderText",value:function(){this.inputRef.current.placeholder=""}},{key:"render",value:function(){var t=""==this.state.identity;return Object(a.jsx)("div",{className:"app",children:null===this.state.room?Object(a.jsxs)("div",{className:"lobby",children:[Object(a.jsx)("input",{ref:this.inputRef,value:this.state.identity,onClick:this.removePlaceholderText,onChange:this.updateIdentity,placeholder:"What's your name?"}),Object(a.jsx)("button",{disabled:t,onClick:this.joinRoom,children:"Join Room"})]}):Object(a.jsx)(P,{leaveRoom:this.leaveRoom,room:this.state.room})})}}]),n}(r.Component),D=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,194)).then((function(e){var n=e.getCLS,i=e.getFID,a=e.getFCP,r=e.getLCP,c=e.getTTFB;n(t),i(t),a(t),r(t),c(t)}))};s.a.render(Object(a.jsx)(c.a.StrictMode,{children:Object(a.jsx)(F,{})}),document.getElementById("root")),D()},85:function(t,e,n){},87:function(t,e,n){},88:function(t,e,n){},89:function(t,e,n){},90:function(t,e,n){}},[[193,1,2]]]);
//# sourceMappingURL=main.19187e98.chunk.js.map