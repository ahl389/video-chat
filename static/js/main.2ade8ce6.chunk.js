(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{189:function(t,e,n){"use strict";n.r(e);var i=n(1),a=n(5),c=n.n(a),o=n(78),r=n.n(o),s=(n(85),n(33)),u=n.n(s),p=n(79),d=n(9),h=n(10),l=n(7),j=n(12),f=n(11),m=(n.p,n(19),n(18)),v=function(t){Object(j.a)(n,t);var e=Object(f.a)(n);function n(t){var i;return Object(d.a)(this,n),(i=e.call(this,t)).ref=c.a.createRef(),i}return Object(h.a)(n,[{key:"componentDidMount",value:function(){null!=this.props.track&&this.ref.current.appendChild(this.props.track.attach())}},{key:"render",value:function(){return Object(i.jsx)("div",{className:"track",ref:this.ref})}}]),n}(a.Component),b=function(t){Object(j.a)(n,t);var e=Object(f.a)(n);function n(t){var i;return Object(d.a)(this,n),(i=e.call(this,t)).state={tracks:[]},i.addTrack=i.addTrack.bind(Object(l.a)(i)),i}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var t=this,e=Array.from(this.props.participant.tracks.values()).map((function(t){return t.track}));this.setState({tracks:e}),this.props.participant.on("trackSubscribed",(function(e){return t.addTrack(e)}))}},{key:"addTrack",value:function(t){this.setState({tracks:[].concat(Object(m.a)(this.state.tracks),[t])})}},{key:"render",value:function(){var t=this;return Object(i.jsxs)("div",{className:"participant",id:this.props.participant.identity,children:[Object(i.jsx)("div",{className:"identity",children:this.props.participant.identity}),this.state.tracks.length>0?this.state.tracks.map((function(e){return Object(i.jsx)(v,{owner:t.props.participant.identity,track:e},e)})):""]})}}]),n}(a.Component),k=function(t){Object(j.a)(n,t);var e=Object(f.a)(n);function n(t){var i;return Object(d.a)(this,n),(i=e.call(this,t)).state={participants:[]},i}return Object(h.a)(n,[{key:"componentDidMount",value:function(){var t=this,e=Array.from(this.props.room.participants.values());this.setState({participants:[].concat(Object(m.a)(e),[this.props.room.localParticipant])}),this.props.room.on("participantConnected",(function(e){return t.addParticipant(e)})),this.props.room.on("participantDisconnected",(function(e){return t.removeParticipant(e)}))}},{key:"componentWillUnmount",value:function(){this.props.room.disconnect()}},{key:"addParticipant",value:function(t){console.log("".concat(t.identity," has joined the room.")),this.setState({participants:[].concat(Object(m.a)(this.state.participants),[t])})}},{key:"removeParticipant",value:function(t){console.log("".concat(t.identity," has left the room")),this.setState({participants:this.state.participants.filter((function(e){return e.identity!=t.identity}))})}},{key:"render",value:function(){return Object(i.jsx)("div",{className:"room",children:this.state.participants.length>0?this.state.participants.map((function(t){return Object(i.jsx)(b,{participant:t},t.identity)})):""})}}]),n}(a.Component),O=function(t){Object(j.a)(a,t);var e=Object(f.a)(a);function a(t){var n;return Object(d.a)(this,a),(n=e.call(this,t)).state={identity:"",room:null,inRoom:!1},n.inputRef=c.a.createRef(),n.joinRoom=n.joinRoom.bind(Object(l.a)(n)),n.leaveRoom=n.leaveRoom.bind(Object(l.a)(n)),n.updateIdentity=n.updateIdentity.bind(Object(l.a)(n)),n.focusTextInput=n.focusTextInput.bind(Object(l.a)(n)),n}return Object(h.a)(a,[{key:"componentDidMount",value:function(){var t=n(87).connect;this.setState({connect:t})}},{key:"updateIdentity",value:function(t){this.setState({identity:t.target.value})}},{key:"focusTextInput",value:function(){this.inputRef.current.placeholder=""}},{key:"joinRoom",value:function(){var t=Object(p.a)(u.a.mark((function t(){var e,n,i;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("https://backend-9288-dev.twil.io/token?identity=".concat(this.state.identity));case 3:return e=t.sent,t.next=6,e.json();case 6:return n=t.sent,t.next=9,this.state.connect(n.accessToken,{name:"secret-santa4",audio:!0,video:{width:640}});case 9:i=t.sent,this.setState({room:i,inRoom:!0}),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),console.log(t.t0);case 16:case"end":return t.stop()}}),t,this,[[0,13]])})));return function(){return t.apply(this,arguments)}}()},{key:"leaveRoom",value:function(){this.state.room.disconnect(),this.setState({room:null,inRoom:!1})}},{key:"render",value:function(){return Object(i.jsx)("div",{className:"app",children:this.state.inRoom?Object(i.jsxs)("div",{className:"active",children:[Object(i.jsx)(k,{room:this.state.room}),Object(i.jsx)("button",{id:"leaveRoom",onClick:this.leaveRoom,children:"Leave Room"})]}):Object(i.jsxs)("div",{className:"inactive",children:[Object(i.jsx)("input",{ref:this.inputRef,value:this.state.identity,onClick:this.focusTextInput,onChange:this.updateIdentity,placeholder:"What's your name?"}),""==!this.state.identity?Object(i.jsx)("button",{onClick:this.joinRoom,children:"Join Room"}):Object(i.jsx)("button",{disabled:!0,onClick:this.joinRoom,children:"Join Room"})]})})}}]),a}(a.Component),y=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,190)).then((function(e){var n=e.getCLS,i=e.getFID,a=e.getFCP,c=e.getLCP,o=e.getTTFB;n(t),i(t),a(t),c(t),o(t)}))};r.a.render(Object(i.jsx)(c.a.StrictMode,{children:Object(i.jsx)(O,{})}),document.getElementById("root")),y()},19:function(t,e,n){},85:function(t,e,n){}},[[189,1,2]]]);
//# sourceMappingURL=main.2ade8ce6.chunk.js.map