(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{13:function(t,e,n){},193:function(t,e,n){"use strict";n.r(e);var a={};n.r(a),n.d(a,"None",(function(){return k})),n.d(a,"Snowfall",(function(){return b})),n.d(a,"GreenRed",(function(){return O})),n.d(a,"Twinkle",(function(){return y})),n.d(a,"BlackWhite",(function(){return g}));var i=n(0),r=n(3),c=n.n(r),o=n(78),s=n.n(o),l=(n(85),n(33)),u=n.n(l),h=n(79),p=n(8),d=n(9),f=n(6),m=n(11),v=n(10),j=(n(13),n(22));function k(t){return Object(i.jsx)("div",{className:"filter none"})}n(87);function b(t){return Object(i.jsx)("div",{className:"filter snowfall",children:Array(100).fill().map((function(t){return Object(i.jsx)("div",{className:"snowflake"})}))})}n(88);function O(t){return Object(i.jsx)("div",{className:"filter green_red"})}n(89);var y=function(t){Object(m.a)(n,t);var e=Object(v.a)(n);function n(t){var a;return Object(p.a)(this,n),(a=e.call(this,t)).state={height:30},a.twinkle=c.a.createRef(),a.setHeight=a.setHeight.bind(Object(f.a)(a)),a}return Object(d.a)(n,[{key:"componentDidMount",value:function(){window.addEventListener("resize",this.setHeight)}},{key:"setHeight",value:function(){var t=2*this.twinkle.current.width;this.setState({height:t})}},{key:"render",value:function(){var t=this;return Object(i.jsx)("div",{className:"filter twinkle",ref:this.twinkle,children:Array(7).fill().map((function(e){return Object(i.jsxs)("div",{className:"light",style:{height:t.state.height},children:[Object(i.jsx)("div",{className:"fixture"}),Object(i.jsx)("div",{className:"bulb"}),Object(i.jsx)("div",{className:"string"})]})}))})}}]),n}(r.Component),g=(n(90),function(t){Object(m.a)(n,t);var e=Object(v.a)(n);function n(t){var a;return Object(p.a)(this,n),(a=e.call(this,t)).state={video:null},a.ref=c.a.createRef(),a}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var t=this.ref.current.parentElement.parentElement.querySelector(".video").firstChild;t.style.webkitFilter="grayscale(100%)",this.setState({video:t})}},{key:"componentWillUnmount",value:function(){this.state.video.style.webkitFilter="none"}},{key:"render",value:function(){return Object(i.jsx)("div",{className:"filter black_white",ref:this.ref})}}]),n}(r.Component));var x=function(t){var e=a[t.name];return Object(i.jsx)(e,{})};var S=function(t){var e;return console.log(t.trackOff),e=t.trackOff?"audio"===t.type?"microphone-slash":"video-slash":"audio"===t.type?"microphone":"video",Object(i.jsx)("div",{className:"avControl",children:Object(i.jsx)("i",{className:"fas fa-lg fa-".concat(e),onClick:function(){return t.toggleTrack()}})})},R=function(t){Object(m.a)(n,t);var e=Object(v.a)(n);function n(t){var a;return Object(p.a)(this,n),(a=e.call(this,t)).state={filter:"",trackOff:!1},a.ref=c.a.createRef(),a.toggleTrack=a.toggleTrack.bind(Object(f.a)(a)),a}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var t=this;if(this.props.track)if("data"!==this.props.track.kind){var e=this.props.track.attach();this.ref.current.classList.add(this.props.track.kind),this.ref.current.appendChild(e)}else this.props.track.on("message",(function(e){t.setState({filter:e})}))}},{key:"toggleTrack",value:function(){console.log("toggling"),this.state.trackOff?this.props.track.enable():this.props.track.disable(),this.setState({trackOff:!this.state.trackOff})}},{key:"render",value:function(){return Object(i.jsxs)("div",{className:"track",ref:this.ref,children:[this.props.track&&"data"===this.props.track.kind?Object(i.jsx)(x,{name:this.state.filter||this.props.filter}):"",this.props.local&&this.props.track&&"data"!==this.props.track.kind?Object(i.jsx)(S,{toggleTrack:this.toggleTrack,trackOff:this.state.trackOff,type:this.props.track.kind}):""]})}}]),n}(r.Component);var w=function(t){return Object(i.jsx)("div",{className:"filterMenu",children:[{name:"None",icon:"fa-ban"},{name:"Snowfall",icon:"fa-snowflake"},{name:"GreenRed",icon:"fa-holly-berry"},{name:"Twinkle",icon:"fa-lights-holiday"}].map((function(e){return Object(i.jsx)("div",{className:"icon icon-".concat(e.name),onClick:function(){return t.changeFilter(e.name)},children:Object(i.jsx)("i",{class:"fas fa-lg ".concat(e.icon)})})}))})},N=function(t){Object(m.a)(n,t);var e=Object(v.a)(n);function n(t){var a;Object(p.a)(this,n),a=e.call(this,t);var i=Array.from(a.props.participant.tracks.values()).map((function(t){return t.track})).filter((function(t){return null!==t}));return a.state={tracks:i,filter:"None"},a.changeFilter=a.changeFilter.bind(Object(f.a)(a)),a}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var t=this;this.props.localParticipant||(this.props.participant.on("trackSubscribed",(function(e){return t.addTrack(e)})),this.props.participant.on("trackPublished",(function(e){return t.addTrack(e.track)})))}},{key:"addTrack",value:function(t){this.setState({tracks:[].concat(Object(j.a)(this.state.tracks),[t])})}},{key:"changeFilter",value:function(t){this.state.tracks.find((function(t){return"data"==t.kind})).send(t),this.setState({filter:t})}},{key:"render",value:function(){var t=this,e=this.props.dominantSpeaker===this.props.participant.identity?"dominantSpeaker":"";return Object(i.jsxs)("div",{className:"participant ".concat(e),id:this.props.participant.identity,children:[Object(i.jsx)("div",{className:"identity",children:this.props.participant.identity}),this.props.localParticipant?Object(i.jsx)(w,{changeFilter:this.changeFilter}):"",this.state.tracks.map((function(e){return Object(i.jsx)(R,{filter:t.state.filter,local:t.props.localParticipant,track:e},e)}))]})}}]),n}(r.Component),P=function(t){Object(m.a)(n,t);var e=Object(v.a)(n);function n(t){var a;return Object(p.a)(this,n),(a=e.call(this,t)).state={remoteParticipants:Array.from(a.props.room.participants.values())},a.leaveRoom=a.leaveRoom.bind(Object(f.a)(a)),a}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var t=this;this.props.room.on("participantConnected",(function(e){return t.addParticipant(e)})),this.props.room.on("participantDisconnected",(function(e){return t.removeParticipant(e)})),this.props.room.on("dominantSpeakerChanged",(function(e){return t.highlightDominantSpeaker(e)})),window.addEventListener("beforeunload",this.leaveRoom)}},{key:"componentWillUnmount",value:function(){this.leaveRoom()}},{key:"leaveRoom",value:function(){this.props.room.disconnect(),this.props.leaveRoom()}},{key:"addParticipant",value:function(t){console.log("".concat(t.identity," has joined the room.")),this.setState({remoteParticipants:[].concat(Object(j.a)(this.state.remoteParticipants),[t])})}},{key:"removeParticipant",value:function(t){console.log("".concat(t.identity," has left the room")),this.setState({remoteParticipants:this.state.remoteParticipants.filter((function(e){return e.identity!=t.identity}))})}},{key:"highlightDominantSpeaker",value:function(t){this.setState({dominantSpeaker:t?t.identity:null})}},{key:"render",value:function(){var t=this;return Object(i.jsxs)("div",{className:"room",children:[Object(i.jsxs)("div",{className:"participants",children:[Object(i.jsx)(N,{dominantSpeaker:this.state.dominantSpeaker,localParticipant:"true",participant:this.props.room.localParticipant},this.props.room.localParticipant.identity),this.state.remoteParticipants.map((function(e){return Object(i.jsx)(N,{dominantSpeaker:t.state.dominantSpeaker,participant:e},e.identity)}))]}),Object(i.jsx)("button",{id:"leaveRoom",onClick:this.leaveRoom,children:"Leave Room"})]})}}]),n}(r.Component),C=n(91),T=C.connect,F=C.LocalDataTrack,D=function(t){Object(m.a)(n,t);var e=Object(v.a)(n);function n(t){var a;return Object(p.a)(this,n),(a=e.call(this,t)).state={identity:"",room:null},a.inputRef=c.a.createRef(),a.joinRoom=a.joinRoom.bind(Object(f.a)(a)),a.leaveRoom=a.leaveRoom.bind(Object(f.a)(a)),a.updateIdentity=a.updateIdentity.bind(Object(f.a)(a)),a.removePlaceholderText=a.removePlaceholderText.bind(Object(f.a)(a)),a}return Object(d.a)(n,[{key:"joinRoom",value:function(){var t=Object(h.a)(u.a.mark((function t(){var e,n,a,i;return u.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("https://backend-9288-dev.twil.io/token?identity=".concat(this.state.identity));case 3:return e=t.sent,t.next=6,e.json();case 6:return n=t.sent,t.next=9,T(n.accessToken,{name:"secret-santa4",audio:!0,video:!0,dominantSpeaker:!0});case 9:return a=t.sent,i=new F,t.next=13,a.localParticipant.publishTrack(i);case 13:this.setState({room:a}),t.next=19;break;case 16:t.prev=16,t.t0=t.catch(0),console.log(t.t0);case 19:case"end":return t.stop()}}),t,this,[[0,16]])})));return function(){return t.apply(this,arguments)}}()},{key:"leaveRoom",value:function(){this.setState({room:null})}},{key:"updateIdentity",value:function(t){this.setState({identity:t.target.value})}},{key:"removePlaceholderText",value:function(){this.inputRef.current.placeholder=""}},{key:"render",value:function(){var t=""==this.state.identity;return Object(i.jsx)("div",{className:"app",children:null===this.state.room?Object(i.jsxs)("div",{className:"lobby",children:[Object(i.jsx)("input",{ref:this.inputRef,value:this.state.identity,onClick:this.removePlaceholderText,onChange:this.updateIdentity,placeholder:"What's your name?"}),Object(i.jsx)("button",{disabled:t,onClick:this.joinRoom,children:"Join Room"})]}):Object(i.jsx)(P,{leaveRoom:this.leaveRoom,room:this.state.room})})}}]),n}(r.Component),L=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,194)).then((function(e){var n=e.getCLS,a=e.getFID,i=e.getFCP,r=e.getLCP,c=e.getTTFB;n(t),a(t),i(t),r(t),c(t)}))};s.a.render(Object(i.jsx)(c.a.StrictMode,{children:Object(i.jsx)(D,{})}),document.getElementById("root")),L()},85:function(t,e,n){},87:function(t,e,n){},88:function(t,e,n){},89:function(t,e,n){},90:function(t,e,n){}},[[193,1,2]]]);
//# sourceMappingURL=main.de4e7fc1.chunk.js.map