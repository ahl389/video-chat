(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{13:function(t,e,n){},189:function(t,e,n){"use strict";n.r(e);var a=n(0),i=n(5),c=n.n(i),r=n(78),o=n.n(r),s=(n(85),n(33)),l=n.n(s),u=n(79),p=n(9),d=n(10),h=n(7),m=n(12),j=n(11),v=(n(13),n(19)),f=function(t){Object(m.a)(n,t);var e=Object(j.a)(n);function n(t){var a;return Object(p.a)(this,n),(a=e.call(this,t)).ref=c.a.createRef(),a}return Object(d.a)(n,[{key:"componentDidMount",value:function(){null!=this.props.track&&this.ref.current.appendChild(this.props.track.attach())}},{key:"render",value:function(){return Object(a.jsx)("div",{className:"track",ref:this.ref})}}]),n}(i.Component);var b=function(t){return Object(a.jsx)("div",{className:"icon icon-".concat(t.name),onClick:function(){return t.changeFilter(t.name)},children:Object(a.jsx)("img",{src:"".concat(t.name,".png"),alt:"icon for ".concat(t.name," filter")})})};var O=function(t){return Object(a.jsx)("div",{className:"filterMenu",children:["none","snowfall","green_red","twinkle"].map((function(e){return Object(a.jsx)(b,{changeFilter:t.changeFilter,name:e},e)}))})};var k=function(t){return Object(a.jsxs)("div",{className:"filter ".concat(t.name),children:["snowfall"==t.name?Array(100).fill().map((function(t){return Object(a.jsx)("div",{className:"snowflake"})})):"","twinkle"==t.name?Array(25).fill().map((function(t){return Object(a.jsx)("div",{className:"light"})})):""]})},y=function(t){Object(m.a)(n,t);var e=Object(j.a)(n);function n(t){var a;return Object(p.a)(this,n),(a=e.call(this,t)).state={tracks:[],filter:"none"},a.addTrack=a.addTrack.bind(Object(h.a)(a)),a.changeFilter=a.changeFilter.bind(Object(h.a)(a)),a}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var t=this,e=Array.from(this.props.participant.tracks.values()).map((function(t){return t.track}));this.setState({tracks:e}),this.props.participant.on("trackSubscribed",(function(e){return t.addTrack(e)}))}},{key:"addTrack",value:function(t){this.setState({tracks:[].concat(Object(v.a)(this.state.tracks),[t])})}},{key:"changeFilter",value:function(t){this.setState({filter:t})}},{key:"render",value:function(){var t=this;return Object(a.jsxs)("div",{className:"participant",id:this.props.participant.identity,children:[Object(a.jsx)("div",{className:"identity",children:this.props.participant.identity}),this.state.tracks.length>0?this.state.tracks.map((function(e){return Object(a.jsx)(f,{owner:t.props.participant.identity,track:e},e)})):"",Object(a.jsx)(O,{changeFilter:this.changeFilter}),Object(a.jsx)(k,{name:this.state.filter})]})}}]),n}(i.Component),x=function(t){Object(m.a)(n,t);var e=Object(j.a)(n);function n(t){var a;return Object(p.a)(this,n),(a=e.call(this,t)).state={participants:[]},a.leaveRoom=a.leaveRoom.bind(Object(h.a)(a)),a}return Object(d.a)(n,[{key:"componentDidMount",value:function(){var t=this,e=Array.from(this.props.room.participants.values());this.setState({participants:[].concat(Object(v.a)(e),[this.props.room.localParticipant])}),this.props.room.on("participantConnected",(function(e){return t.addParticipant(e)})),this.props.room.on("participantDisconnected",(function(e){return t.removeParticipant(e)})),window.addEventListener("beforeunload",this.leaveRoom)}},{key:"componentWillUnmount",value:function(){this.leaveRoom()}},{key:"leaveRoom",value:function(){this.props.room.disconnect(),this.props.leaveRoom()}},{key:"addParticipant",value:function(t){console.log("".concat(t.identity," has joined the room.")),this.setState({participants:[].concat(Object(v.a)(this.state.participants),[t])})}},{key:"removeParticipant",value:function(t){console.log("".concat(t.identity," has left the room")),this.setState({participants:this.state.participants.filter((function(e){return e.identity!=t.identity}))})}},{key:"render",value:function(){return Object(a.jsxs)("div",{className:"room",children:[Object(a.jsx)("div",{class:"participants",children:this.state.participants.length>0?this.state.participants.map((function(t){return Object(a.jsx)(y,{participant:t},t.identity)})):""}),Object(a.jsx)("button",{id:"leaveRoom",onClick:this.leaveRoom,children:"Leave Room"})]})}}]),n}(i.Component),g=function(t){Object(m.a)(i,t);var e=Object(j.a)(i);function i(t){var n;return Object(p.a)(this,i),(n=e.call(this,t)).state={identity:"",room:null},n.inputRef=c.a.createRef(),n.joinRoom=n.joinRoom.bind(Object(h.a)(n)),n.leaveRoom=n.leaveRoom.bind(Object(h.a)(n)),n.updateIdentity=n.updateIdentity.bind(Object(h.a)(n)),n.removePlaceholderText=n.removePlaceholderText.bind(Object(h.a)(n)),n}return Object(d.a)(i,[{key:"componentDidMount",value:function(){var t=n(87).connect;this.setState({connect:t})}},{key:"updateIdentity",value:function(t){this.setState({identity:t.target.value})}},{key:"removePlaceholderText",value:function(){this.inputRef.current.placeholder=""}},{key:"joinRoom",value:function(){var t=Object(u.a)(l.a.mark((function t(){var e,n,a;return l.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("https://backend-9288-dev.twil.io/token?identity=".concat(this.state.identity));case 3:return e=t.sent,t.next=6,e.json();case 6:return n=t.sent,t.next=9,this.state.connect(n.accessToken,{name:"secret-santa4",audio:!0,video:!0});case 9:a=t.sent,this.setState({room:a}),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),console.log(t.t0);case 16:case"end":return t.stop()}}),t,this,[[0,13]])})));return function(){return t.apply(this,arguments)}}()},{key:"leaveRoom",value:function(){this.setState({room:null})}},{key:"render",value:function(){var t=""==this.state.identity;return Object(a.jsx)("div",{className:"app",children:null===this.state.room?Object(a.jsxs)("div",{className:"inactive",children:[Object(a.jsx)("input",{ref:this.inputRef,value:this.state.identity,onClick:this.removePlaceholderText,onChange:this.updateIdentity,placeholder:"What's your name?"}),Object(a.jsx)("button",{disabled:t,onClick:this.joinRoom,children:"Join Room"})]}):Object(a.jsx)(x,{leaveRoom:this.leaveRoom,room:this.state.room})})}}]),i}(i.Component),R=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,190)).then((function(e){var n=e.getCLS,a=e.getFID,i=e.getFCP,c=e.getLCP,r=e.getTTFB;n(t),a(t),i(t),c(t),r(t)}))};o.a.render(Object(a.jsx)(c.a.StrictMode,{children:Object(a.jsx)(g,{})}),document.getElementById("root")),R()},85:function(t,e,n){}},[[189,1,2]]]);
//# sourceMappingURL=main.da058823.chunk.js.map